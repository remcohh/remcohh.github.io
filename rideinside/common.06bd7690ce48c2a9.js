"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8592],{3620:(m,d,s)=>{s.r(d),s.d(d,{startFocusVisible:()=>u});const a="ion-focused",c=["Tab","ArrowDown","Space","Escape"," ","Shift","Enter","ArrowLeft","ArrowRight","ArrowUp","Home","End"],u=n=>{let v=[],e=!0;const t=n?n.shadowRoot:document,l=n||document.body,r=h=>{v.forEach(_=>_.classList.remove(a)),h.forEach(_=>_.classList.add(a)),v=h},o=()=>{e=!1,r([])},w=h=>{e=c.includes(h.key),e||r([])},p=h=>{if(e&&h.composedPath){const _=h.composedPath().filter(E=>!!E.classList&&E.classList.contains("ion-focusable"));r(_)}},g=()=>{t.activeElement===l&&r([])};return t.addEventListener("keydown",w),t.addEventListener("focusin",p),t.addEventListener("focusout",g),t.addEventListener("touchstart",o),t.addEventListener("mousedown",o),{destroy:()=>{t.removeEventListener("keydown",w),t.removeEventListener("focusin",p),t.removeEventListener("focusout",g),t.removeEventListener("touchstart",o),t.removeEventListener("mousedown",o)},setFocus:r}}},8107:(m,d,s)=>{s.d(d,{a:()=>a,b:()=>t,c:()=>i,d:()=>n,e:()=>l,f:()=>e,g:()=>v,h:()=>u,i:()=>c});const a="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Arrow Down</title><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M112 268l144 144 144-144M256 392V100' class='ionicon-fill-none'/></svg>",i="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Caret Back</title><path d='M368 64L144 256l224 192V64z'/></svg>",c="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Caret Down</title><path d='M64 144l192 224 192-224H64z'/></svg>",u="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Caret Up</title><path d='M448 368L256 144 64 368h384z'/></svg>",n="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Chevron Back</title><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M328 112L184 256l144 144' class='ionicon-fill-none'/></svg>",v="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Chevron Down</title><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M112 184l144 144 144-144' class='ionicon-fill-none'/></svg>",e="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Chevron Forward</title><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M184 112l144 144-144 144' class='ionicon-fill-none'/></svg>",t="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Chevron Forward</title><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M184 112l144 144-144 144' class='ionicon-fill-none'/></svg>",l="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><title>Ellipsis Horizontal</title><circle cx='256' cy='256' r='48'/><circle cx='416' cy='256' r='48'/><circle cx='96' cy='256' r='48'/></svg>"},9900:(m,d,s)=>{s.d(d,{V:()=>u});var a=s(4762),i=s(6079),c=s(8621);let u=(()=>{class n{constructor(e){this.storage=e,this._storage=null,this.init()}init(){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.storage.create();this._storage=e})}set(e,t){var l;null===(l=this._storage)||void 0===l||l.set(e,t)}get(e){var t;return null===(t=this._storage)||void 0===t?void 0:t.get(e)}}return n.\u0275fac=function(e){return new(e||n)(i.LFG(c.K))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},3982:(m,d,s)=>{s.d(d,{R:()=>e});var a=s(4762),i=s(8260),c=s(6079),u=s(8621),n=s(9949),v=s(4522);let e=(()=>{class t{constructor(r,o,w){this.storage=r,this.router=o,this.http=w}getAccessToken(r){return(0,a.mG)(this,void 0,void 0,function*(){this.http.post(i.N.strava.tokenUrl,Object.assign({client_id:i.N.strava.clientId,client_secret:i.N.strava.clientSecret},r)).subscribe({next:o=>{console.log("Response",o),this.storage.set("access_token",o.access_token),this.storage.set("refresh_token",o.refresh_token),this.storage.set("expires_at",o.expires_at),this.router.navigate(["/","ride"])},error:o=>{console.warn(o.message||o),this.router.navigate(["/","settings"])}})})}uploadActivity(r){return(0,a.mG)(this,void 0,void 0,function*(){const o=new Blob([r],{type:"text/plain"}),p={Authorization:`Bearer ${yield this.storage.get("access_token")}`},g=new FormData;g.append("activity_type","virtualride"),g.append("name","Virtual ride"),g.append("data_type","tcx"),g.append("file",o,"ride.tcx");const f=yield fetch(i.N.strava.uploadUrl,{method:"POST",body:g,headers:p});console.log("response",f)})}tokenValid(){return(0,a.mG)(this,void 0,void 0,function*(){return(yield this.storage.get("expires_at"))-Math.round(+new Date/1e3)>60})}}return t.\u0275fac=function(r){return new(r||t)(c.LFG(u.K),c.LFG(n.F0),c.LFG(v.eN))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);